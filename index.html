<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQUAD MANAGER PRO - v23</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #f8fafc;
        }

        .card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 12px;
        }

        .input-field {
            background: #0f172a;
            border: 1px solid #334155;
            color: white;
            padding: 10px;
            border-radius: 8px;
            width: 100%;
            font-size: 0.875rem;
        }

        .positive {
            color: #4ade80;
        }

        .negative {
            color: #f87171;
        }

        .pos-gl {
            background: #166534;
            color: #4ade80;
        }

        .pos-def {
            background: #1e40af;
            color: #93c5fd;
        }

        .pos-meio {
            background: #854d0e;
            color: #fde047;
        }

        .pos-ata {
            background: #991b1b;
            color: #fca5a5;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 10px;
        }

        .sidebar-transition {
            transition: transform 0.3s ease-in-out;
        }

        .sidebar-open {
            transform: translateX(0);
        }

        .sidebar-closed {
            transform: translateX(100%);
        }

        .ovr-low {
            background: #7f1d1d;
            color: #fca5a5;
        }

        .ovr-mid {
            background: #854d0e;
            color: #fde047;
        }

        .ovr-high {
            background: #065f46;
            color: #6ee7b7;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab-button.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
            background: #1e293b;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .modal-backdrop {
            backdrop-filter: blur(8px);
            animation: fadeIn 0.2s ease-out;
        }

        .modal-content {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to { 
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .success-icon {
            animation: successPop 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes successPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .alert-shake {
            animation: shake 0.4s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .modal-content {
                max-width: 95vw;
                margin: 0 auto;
            }

            .grid-mobile {
                grid-template-columns: 1fr !important;
            }

            .hide-mobile {
                display: none !important;
            }

            .text-mobile-sm {
                font-size: 0.75rem !important;
            }

            .overflow-x-scroll {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .table-mobile {
                display: block;
                width: 100%;
            }

            .table-mobile tr {
                display: flex;
                flex-direction: column;
                border: 1px solid #334155;
                border-radius: 8px;
                padding: 12px;
                margin-bottom: 8px;
                background: #1e293b;
            }

            .table-mobile td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 6px 0 !important;
                border: none !important;
            }

            .table-mobile td::before {
                content: attr(data-label);
                font-weight: bold;
                color: #94a3b8;
                font-size: 0.7rem;
                text-transform: uppercase;
            }
        }

        @media (max-width: 640px) {
            body {
                padding: 0.5rem !important;
            }

            .card {
                padding: 1rem !important;
            }

            h1 {
                font-size: 1.25rem !important;
            }

            .input-field {
                font-size: 0.75rem !important;
                padding: 8px !important;
            }
        }
    </style>
</head>

<body class="p-4 md:p-6">

    <!-- Modal Principal -->
    <div id="modalOverlay"
        class="fixed inset-0 z-50 hidden flex items-center justify-center p-4 bg-black/70 modal-backdrop">
        <div class="card w-full max-w-2xl p-0 max-h-[90vh] overflow-hidden shadow-2xl modal-content border-2 border-slate-600">
            <div class="bg-gradient-to-r from-blue-600 to-blue-700 p-5 border-b border-blue-500">
                <h2 id="modalTitle" class="text-xl font-bold text-white uppercase tracking-wide flex items-center gap-2">
                    <i class="fas fa-cog"></i> A√ß√£o
                </h2>
            </div>
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-180px)]">
                <div id="modalBody" class="space-y-4"></div>
            </div>
            <div class="flex justify-end gap-3 p-5 bg-slate-800/50 border-t border-slate-700">
                <button onclick="closeModal()" 
                    class="px-6 py-2.5 text-slate-300 hover:text-white hover:bg-slate-700 rounded-lg font-semibold transition-all">
                    Cancelar
                </button>
                <button id="modalConfirmBtn" 
                    class="px-6 py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all transform hover:scale-105">
                    Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Boas-Vindas/Changelog -->
    <div id="welcomeModal"
        class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4 bg-black/80 modal-backdrop">
        <div class="card w-full max-w-3xl p-0 max-h-[90vh] overflow-hidden shadow-2xl modal-content border-2 border-blue-500">
            <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 p-6 text-center">
                <div class="text-6xl mb-3 animate-bounce">üéâ</div>
                <h2 class="text-2xl sm:text-3xl font-bold text-white uppercase tracking-wide mb-2">
                    Atualiza√ß√£o v23!
                </h2>
                <p class="text-blue-100 text-sm">Squad Manager Pro acabou de ficar ainda melhor!</p>
            </div>
            <div class="p-6 overflow-y-auto max-h-[calc(90vh-250px)]">
                <div class="space-y-6">
                    <!-- Feature 1 -->
                    <div class="card p-4 bg-gradient-to-br from-blue-500/10 to-blue-600/5 border border-blue-500/30">
                        <div class="flex items-start gap-3">
                            <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-folder-open text-xl text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-white mb-1 text-lg">üóÇÔ∏è Sistema de M√∫ltiplas Carreiras</h3>
                                <p class="text-slate-300 text-sm mb-2">Agora voc√™ pode criar e gerenciar v√°rias carreiras simultaneamente!</p>
                                <ul class="text-xs text-slate-400 space-y-1">
                                    <li>‚úì Crie quantas carreiras quiser</li>
                                    <li>‚úì Alterne entre elas a qualquer momento</li>
                                    <li>‚úì Cada carreira mant√©m seus pr√≥prios dados</li>
                                    <li>‚úì Renomeie e organize como preferir</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Feature 2 -->
                    <div class="card p-4 bg-gradient-to-br from-purple-500/10 to-purple-600/5 border border-purple-500/30">
                        <div class="flex items-start gap-3">
                            <div class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-window-maximize text-xl text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-white mb-1 text-lg">‚ú® Modais Redesenhados</h3>
                                <p class="text-slate-300 text-sm mb-2">Interface completamente renovada com modais modernos e intuitivos!</p>
                                <ul class="text-xs text-slate-400 space-y-1">
                                    <li>‚úì Design profissional com anima√ß√µes suaves</li>
                                    <li>‚úì Feedback visual em todas as a√ß√µes</li>
                                    <li>‚úì Confirma√ß√µes duplas para a√ß√µes cr√≠ticas</li>
                                    <li>‚úì √çcones grandes e informativos</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Feature 3 -->
                    <div class="card p-4 bg-gradient-to-br from-green-500/10 to-green-600/5 border border-green-500/30">
                        <div class="flex items-start gap-3">
                            <div class="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-mobile-alt text-xl text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-white mb-1 text-lg">üì± Totalmente Responsivo</h3>
                                <p class="text-slate-300 text-sm mb-2">Experi√™ncia perfeita em qualquer dispositivo!</p>
                                <ul class="text-xs text-slate-400 space-y-1">
                                    <li>‚úì Layout otimizado para celular e tablet</li>
                                    <li>‚úì Tabelas transformadas em cards no mobile</li>
                                    <li>‚úì Bot√µes grandes e f√°ceis de tocar</li>
                                    <li>‚úì Navega√ß√£o fluida em telas pequenas</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Feature 4 -->
                    <div class="card p-4 bg-gradient-to-br from-yellow-500/10 to-yellow-600/5 border border-yellow-500/30">
                        <div class="flex items-start gap-3">
                            <div class="w-12 h-12 bg-yellow-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-rocket text-xl text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-white mb-1 text-lg">üöÄ Melhorias Gerais</h3>
                                <ul class="text-xs text-slate-400 space-y-1">
                                    <li>‚úì Sistema de backup e restaura√ß√£o aprimorado</li>
                                    <li>‚úì Confirma√ß√µes visuais em todas as a√ß√µes</li>
                                    <li>‚úì Performance otimizada</li>
                                    <li>‚úì Anima√ß√µes e transi√ß√µes suaves</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Tip -->
                    <div class="card p-4 bg-blue-500/10 border border-blue-500/30">
                        <div class="flex items-start gap-2">
                            <i class="fas fa-lightbulb text-yellow-400 text-lg mt-0.5"></i>
                            <div>
                                <p class="text-sm text-slate-300 font-semibold mb-1">üí° Dica:</p>
                                <p class="text-xs text-slate-400">
                                    Clique no bot√£o com o nome da carreira no topo para acessar o gerenciador de carreiras e criar suas novas saves!
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="p-5 bg-slate-800/50 border-t border-slate-700 text-center">
                <button onclick="closeWelcomeModal()" 
                    class="px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-all transform hover:scale-105">
                    <i class="fas fa-check mr-2"></i>Entendi! Vamos come√ßar! üöÄ
                </button>
                <p class="text-xs text-slate-500 mt-3">Voc√™ pode revisar essas informa√ß√µes a qualquer momento</p>
            </div>
        </div>
    </div>

    <!-- Sidebar de Hist√≥rico -->
    <div id="historySidebar"
        class="fixed top-0 right-0 h-full w-full md:w-96 bg-slate-900 shadow-2xl z-40 sidebar-transition sidebar-closed border-l border-slate-700">
        <div class="h-full flex flex-col">
            <div
                class="p-6 border-b border-slate-700 flex justify-between items-center bg-gradient-to-r from-slate-800 to-slate-900">
                <h2 class="text-lg font-bold text-green-400 uppercase italic flex items-center gap-2">
                    <i class="fas fa-history"></i> Hist√≥rico de Vendas
                </h2>
                <button onclick="closeSidebar()" class="text-slate-400 hover:text-white transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="flex-1 overflow-y-auto p-6">
                <div id="salesLogFull" class="space-y-3"></div>
            </div>

            <div class="p-6 border-t border-slate-700 bg-slate-800/50">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-slate-400 text-sm">Total de Transa√ß√µes:</span>
                    <span id="totalTransactions" class="font-bold text-white">0</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-slate-400 text-sm">Lucro Acumulado:</span>
                    <span id="totalProfitSidebar" class="font-bold text-green-400 text-lg">R$ 0</span>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-[1600px] mx-auto">
        <!-- Bot√µes de Backup -->
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4">
            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3 w-full sm:w-auto">
                <h1 class="text-xl sm:text-2xl font-bold text-blue-400 italic uppercase flex items-center gap-2">
                    Squad Manager Pro
                    <span class="text-[10px] bg-blue-500/20 text-blue-300 px-2 py-0.5 rounded font-normal">v23</span>
                </h1>
                <button onclick="openCareerSelector()" 
                    class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded-lg text-xs font-bold uppercase flex items-center gap-2 border border-slate-600 w-full sm:w-auto justify-center">
                    <i class="fas fa-folder-open"></i> <span id="currentCareerName">Carreira 1</span>
                </button>
            </div>
            <div class="flex flex-wrap gap-2 w-full sm:w-auto">
                <button onclick="openChangelogModal()"
                    class="flex-1 sm:flex-none px-3 sm:px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg text-xs font-bold uppercase flex items-center gap-2 justify-center"
                    title="Ver Novidades">
                    <i class="fas fa-star"></i> <span class="hidden sm:inline">Novidades</span>
                </button>
                <button onclick="openCareerManagementModal()"
                    class="flex-1 sm:flex-none px-3 sm:px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-xs font-bold uppercase flex items-center gap-2 justify-center">
                    <i class="fas fa-cog"></i> <span class="hidden sm:inline">Gerenciar</span><span class="sm:hidden">Carreiras</span>
                </button>
                <button onclick="exportData()"
                    class="flex-1 sm:flex-none px-3 sm:px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg text-xs font-bold uppercase flex items-center gap-2 justify-center">
                    <i class="fas fa-download"></i> <span class="hidden sm:inline">Exportar</span>
                </button>
                <button onclick="document.getElementById('importFile').click()"
                    class="flex-1 sm:flex-none px-3 sm:px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-xs font-bold uppercase flex items-center gap-2 justify-center">
                    <i class="fas fa-upload"></i> <span class="hidden sm:inline">Importar</span>
                </button>
                <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
            </div>
        </div>

        <!-- Tabs -->
        <div class="mb-6 border-b border-slate-700 overflow-x-auto">
            <div class="flex gap-1 min-w-max">
                <button class="tab-button active whitespace-nowrap" onclick="switchTab('profissional')">
                    <i class="fas fa-users"></i> <span class="hidden sm:inline">Elenco </span>Profissional
                </button>
                <button class="tab-button whitespace-nowrap" onclick="switchTab('base')">
                    <i class="fas fa-seedling"></i> Base<span class="hidden sm:inline">/Academia</span>
                </button>
            </div>
        </div>

        <!-- Tab: Elenco Profissional -->
        <div id="tab-profissional" class="tab-content active">
            <!-- Cards de Resumo -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="card p-4 border-l-4 border-l-blue-500">
                    <p class="text-slate-400 text-[10px] uppercase font-bold">Valor Elenco</p>
                    <p id="squadValue" class="text-xl font-bold">R$ 0</p>
                </div>
                <div class="card p-4 border-l-4 border-l-orange-500">
                    <p class="text-slate-400 text-[10px] uppercase font-bold">Emprestados</p>
                    <p id="loanValue" class="text-xl font-bold text-orange-400">R$ 0</p>
                </div>
                <div class="card p-4 border-l-4 border-l-green-500 cursor-pointer hover:bg-slate-800/50 transition"
                    onclick="openSidebar()">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-slate-400 text-[10px] uppercase font-bold">Lucro Total</p>
                            <p id="totalProfit" class="text-xl font-bold text-green-400">R$ 0</p>
                        </div>
                        <i class="fas fa-external-link-alt text-green-400/50 text-sm"></i>
                    </div>
                </div>
                <div class="card p-4 border-l-4 border-l-purple-500">
                    <p class="text-slate-400 text-[10px] uppercase font-bold">Patrim√¥nio</p>
                    <p id="totalEquity" class="text-xl font-bold text-purple-300">R$ 0</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                <!-- Painel Esquerdo -->
                <div class="lg:col-span-3 space-y-4 order-2 lg:order-1">
                    <div class="card p-5 border-blue-500/30">
                        <h2
                            class="text-sm font-bold mb-4 text-blue-400 uppercase italic text-xs flex justify-between items-center">
                            Novo Jogador
                            <button onclick="openBulkRegisterModal()"
                                class="text-[10px] bg-blue-500/20 px-2 py-1 rounded hover:bg-blue-500/30"
                                title="Cadastro em Lote">
                                <i class="fas fa-list"></i> Lote
                            </button>
                        </h2>
                        <input type="text" id="regName" class="input-field mb-2" placeholder="Nome">
                        <input type="text" id="regPos" class="input-field mb-2" placeholder="Posi√ß√£o (ZAG, VOL...)">
                        <input type="number" id="regValue" class="input-field mb-2" placeholder="Valor Compra">
                        <button onclick="registerPlayer()"
                            class="w-full bg-blue-600 py-2 rounded-lg text-[10px] font-bold uppercase">Cadastrar</button>
                    </div>

                    <div class="card p-5 border-purple-500/30">
                        <h2 class="text-sm font-bold mb-4 text-purple-400 uppercase italic text-xs">Simulador de Oferta
                        </h2>
                        <select id="simPlayer" class="input-field mb-2 text-xs"></select>
                        <input type="number" id="simOffer" class="input-field mb-2" placeholder="Valor da Oferta">
                        <div id="simResult"
                            class="p-2 rounded bg-black/40 hidden text-xs mb-2 border border-slate-700 italic"></div>
                        <button onclick="simulateOffer()"
                            class="w-full bg-purple-600 py-2 rounded-lg text-[10px] font-bold uppercase">Analisar
                            Saldo</button>
                    </div>

                    <div class="card p-5 border-green-500/30 bg-green-500/5">
                        <h2 class="text-sm font-bold mb-4 text-green-400 uppercase italic text-xs">Venda R√°pida</h2>
                        <select id="quickSalePlayer" class="input-field mb-2 text-xs"
                            onchange="updateQuickSalePreview()">
                            <option value="">Selecionar Jogador...</option>
                        </select>
                        <div id="quickSaleCost" class="bg-black/40 p-2 rounded border border-slate-700 mb-2 hidden">
                            <div class="flex justify-between text-xs">
                                <span class="text-slate-400">Custo:</span>
                                <span id="quickCostValue" class="font-mono text-white">R$ 0</span>
                            </div>
                        </div>
                        <input type="number" id="quickSalePrice" class="input-field mb-2" placeholder="Valor da Venda"
                            oninput="updateQuickSaleProfit()">
                        <div id="quickSaleProfit" class="bg-black/40 p-2 rounded border border-slate-700 mb-2 hidden">
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-slate-400">Lucro:</span>
                                <span id="quickProfitValue" class="font-bold text-lg positive">R$ 0</span>
                            </div>
                        </div>
                        <button onclick="executeQuickSale()"
                            class="w-full bg-green-600 py-2 rounded-lg text-[10px] font-bold uppercase">Vender e
                            Lan√ßar</button>
                    </div>
                </div>

                <!-- Tabela Principal -->
                <div class="lg:col-span-6 order-1 lg:order-2">
                    <div class="card p-3 sm:p-5">
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4">
                            <h2 class="text-base sm:text-lg font-bold italic uppercase">Gest√£o de Elenco</h2>
                            <input type="text" id="filterPos" onkeyup="updateUI()"
                                class="input-field w-full sm:w-32 py-1 text-[10px]" placeholder="Buscar...">
                        </div>
                        <div class="overflow-x-auto -mx-3 sm:mx-0">
                            <div class="min-w-[500px] sm:min-w-0">
                                <table class="w-full text-sm hidden sm:table">
                                    <tbody id="playerTable"></tbody>
                                </table>
                                <div id="playerTableMobile" class="block sm:hidden"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Painel Direito -->
                <div class="lg:col-span-3 space-y-4 order-3">
                    <div class="card p-5 border-orange-500/30">
                        <h2 class="text-sm font-bold mb-4 text-orange-400 uppercase italic text-xs">Empr√©stimos</h2>
                        <div id="loanList" class="space-y-2 text-[11px]"></div>
                    </div>

                    <div class="card p-5 border-green-500/30 bg-green-500/5 cursor-pointer hover:bg-green-500/10 transition"
                        onclick="openSidebar()">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-sm font-bold text-green-400 uppercase italic text-xs">√öltimas Vendas</h2>
                            <i class="fas fa-arrow-right text-green-400 text-xs"></i>
                        </div>
                        <div id="salesLog" class="space-y-2 text-[11px]"></div>
                        <div class="mt-4 pt-3 border-t border-slate-700 text-center">
                            <button onclick="openSidebar()"
                                class="text-green-400 text-[10px] uppercase font-bold hover:text-green-300 transition">
                                Ver Hist√≥rico Completo <i class="fas fa-chevron-right ml-1"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Base -->
        <div id="tab-base" class="tab-content">
            <!-- Cards de Resumo Base -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="card p-4 border-l-4 border-l-yellow-500">
                    <p class="text-slate-400 text-[10px] uppercase font-bold">Jogadores na Base</p>
                    <p id="youthCount" class="text-xl font-bold text-yellow-400">0</p>
                </div>
                <div class="card p-4 border-l-4 border-l-cyan-500">
                    <p class="text-slate-400 text-[10px] uppercase font-bold">Overall M√©dio</p>
                    <p id="avgOverall" class="text-xl font-bold text-cyan-400">0</p>
                </div>
                <div class="card p-4 border-l-4 border-l-pink-500">
                    <p class="text-slate-400 text-[10px] uppercase font-bold">Potencial M√©dio</p>
                    <p id="avgPotential" class="text-xl font-bold text-pink-400">0</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                <!-- Painel Esquerdo Base -->
                <div class="lg:col-span-4 space-y-4 order-2 lg:order-1">
                    <div class="card p-5 border-yellow-500/30">
                        <h2
                            class="text-sm font-bold mb-4 text-yellow-400 uppercase italic text-xs flex justify-between items-center">
                            Novo Jogador da Base
                            <button onclick="openBulkYouthModal()"
                                class="text-[10px] bg-yellow-500/20 px-2 py-1 rounded hover:bg-yellow-500/30"
                                title="Cadastro em Lote">
                                <i class="fas fa-list"></i> Lote
                            </button>
                        </h2>
                        <input type="text" id="youthName" class="input-field mb-2" placeholder="Nome">
                        <div class="grid grid-cols-2 gap-2 mb-2">
                            <input type="number" id="youthAge" class="input-field" placeholder="Idade" min="14"
                                max="23">
                            <input type="text" id="youthPos" class="input-field" placeholder="Posi√ß√£o">
                        </div>
                        <div class="grid grid-cols-2 gap-2 mb-2">
                            <input type="number" id="youthOverall" class="input-field" placeholder="Overall" min="40"
                                max="99">
                            <input type="number" id="youthPotential" class="input-field" placeholder="Potencial"
                                min="40" max="99">
                        </div>
                        <input type="number" id="youthValue" class="input-field mb-2" placeholder="Valor Estimado">
                        <button onclick="registerYouth()"
                            class="w-full bg-yellow-600 py-2 rounded-lg text-[10px] font-bold uppercase">Cadastrar na
                            Base</button>
                    </div>
                </div>

                <!-- Tabela Base -->
                <div class="lg:col-span-8 order-1 lg:order-2">
                    <div class="card p-3 sm:p-5">
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-4">
                            <h2 class="text-base sm:text-lg font-bold italic uppercase text-yellow-400">
                                <i class="fas fa-seedling mr-2"></i>Academia/Base
                            </h2>
                            <input type="text" id="filterYouth" onkeyup="updateUI()"
                                class="input-field w-full sm:w-32 py-1 text-[10px]" placeholder="Buscar...">
                        </div>
                        <div class="overflow-x-auto -mx-3 sm:mx-0">
                            <div class="min-w-[600px] sm:min-w-0">
                                <table class="w-full text-sm hidden sm:table">
                                    <thead class="sticky top-0 bg-slate-800">
                                        <tr class="border-b border-slate-600">
                                            <th class="text-left py-2 text-[10px] text-slate-400">JOGADOR</th>
                                            <th class="text-center py-2 text-[10px] text-slate-400">IDADE</th>
                                            <th class="text-center py-2 text-[10px] text-slate-400">OVR</th>
                                            <th class="text-center py-2 text-[10px] text-slate-400">POT</th>
                                            <th class="text-right py-2 text-[10px] text-slate-400">VALOR</th>
                                            <th class="text-right py-2 text-[10px] text-slate-400">A√á√ïES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="youthTable"></tbody>
                                </table>
                                <div id="youthTableMobile" class="block sm:hidden"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        const APP_VERSION = 'v23';
        
        if (!localStorage.getItem('initialized_v22')) {
            localStorage.removeItem('squad_v22');
            localStorage.removeItem('loans_v22');
            localStorage.removeItem('sales_v22');
            localStorage.removeItem('youth_v22');
            localStorage.setItem('initialized_v22', 'true');
        }
        const initialSquad = [];


        let currentCareer = localStorage.getItem('currentCareer_v22') || 'carreira_1';
        let careers = JSON.parse(localStorage.getItem('careers_v22')) || {};
        
        // Inicializa a carreira atual se n√£o existir
        if (!careers[currentCareer]) {
            careers[currentCareer] = {
                name: 'Carreira 1',
                players: [],
                loans: [],
                sales: [],
                youth: [],
                createdAt: new Date().toISOString()
            };
        }

        let players = careers[currentCareer].players || [];
        let loans = careers[currentCareer].loans || [];
        let sales = careers[currentCareer].sales || [];
        let youth = careers[currentCareer].youth || [];

        const posOrder = { 'GL': 1, 'ZAG': 2, 'LE': 3, 'LD': 4, 'VOL': 5, 'MC': 6, 'MEI': 7, 'PTE': 8, 'PTD': 9, 'ATA': 10 };

        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`tab-${tab}`).classList.add('active');
        }

        function formatMoney(v) { return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL', maximumFractionDigits: 0 }).format(v); }

        function getPosClass(pos) {
            const p = pos.toUpperCase();
            if (p === 'GL') return 'pos-gl';
            if (['ZAG', 'LD', 'LE'].includes(p)) return 'pos-def';
            if (['VOL', 'MC', 'MEI'].includes(p)) return 'pos-meio';
            return 'pos-ata';
        }

        function getOvrClass(ovr) {
            if (ovr >= 75) return 'ovr-high';
            if (ovr >= 65) return 'ovr-mid';
            return 'ovr-low';
        }

        function openSidebar() {
            document.getElementById('historySidebar').classList.remove('sidebar-closed');
            document.getElementById('historySidebar').classList.add('sidebar-open');
            updateSalesHistory();
        }

        function closeSidebar() {
            document.getElementById('historySidebar').classList.add('sidebar-closed');
            document.getElementById('historySidebar').classList.remove('sidebar-open');
        }

        function updateSalesHistory() {
            const salesFull = document.getElementById('salesLogFull');
            salesFull.innerHTML = '';

            if (sales.length === 0) {
                salesFull.innerHTML = '<p class="text-slate-500 text-center italic">Nenhuma venda registrada</p>';
                return;
            }

            let totalProfit = 0;
            sales.slice().reverse().forEach((s, idx) => {
                const profit = s.sale - s.cost;
                totalProfit += profit;
                salesFull.innerHTML += `
                    <div class="card p-4 hover:bg-slate-800/50 transition">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <p class="font-bold text-white">${s.nome}</p>
                                <p class="text-[10px] text-slate-500">#${sales.length - idx}</p>
                            </div>
                            <button onclick="deleteSale(${sales.length - 1 - idx})" class="text-red-400 hover:text-red-300 text-xs">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-xs mb-2">
                            <div>
                                <p class="text-slate-500">Custo</p>
                                <p class="font-mono text-slate-300">${formatMoney(s.cost)}</p>
                            </div>
                            <div>
                                <p class="text-slate-500">Venda</p>
                                <p class="font-mono text-slate-300">${formatMoney(s.sale)}</p>
                            </div>
                        </div>
                        <div class="pt-2 border-t border-slate-700">
                            <div class="flex justify-between items-center">
                                <span class="text-slate-400 text-xs">Lucro:</span>
                                <span class="font-bold text-lg ${profit >= 0 ? 'positive' : 'negative'}">${formatMoney(profit)}</span>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <span class="text-slate-500 text-[10px]">Margem:</span>
                                <span class="text-slate-400 text-[10px] font-mono">${((profit / s.cost) * 100).toFixed(1)}%</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('totalTransactions').innerText = sales.length;
            document.getElementById('totalProfitSidebar').innerText = formatMoney(totalProfit);
        }

        function deleteSale(idx) {
            const sale = sales[idx];
            showConfirmModal(
                'Excluir Venda',
                `Tem certeza que deseja excluir a venda de <strong class="text-blue-400">${sale.nome}</strong> do hist√≥rico?<br><br>Esta a√ß√£o n√£o pode ser desfeita!`,
                () => {
                    sales.splice(idx, 1);
                    updateUI();
                    updateSalesHistory();
                    showSuccessModal(
                        'Venda Exclu√≠da',
                        `<div class="text-center">
                            <div class="success-icon mb-4">
                                <i class="fas fa-trash-alt text-6xl text-red-400"></i>
                            </div>
                            <p class="text-white">Venda removida do hist√≥rico!</p>
                        </div>`
                    );
                }
            );
        }

        function saveData() {
            careers[currentCareer] = {
                name: careers[currentCareer].name,
                players: players,
                loans: loans,
                sales: sales,
                youth: youth,
                lastUpdate: new Date().toISOString(),
                createdAt: careers[currentCareer].createdAt
            };

            localStorage.setItem('careers_v22', JSON.stringify(careers));
            localStorage.setItem('currentCareer_v22', currentCareer);
        }

        function exportData() {
            const data = {
                players: players,
                loans: loans,
                sales: sales,
                youth: youth,
                exportDate: new Date().toISOString(),
                version: 'v22'
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `squad_manager_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showSuccessModal(
                'Backup Criado!',
                `<div class="text-center">
                    <div class="success-icon mb-4">
                        <i class="fas fa-download text-6xl text-purple-400"></i>
                    </div>
                    <p class="text-xl font-bold text-white mb-2">Dados exportados com sucesso!</p>
                    <p class="text-sm text-slate-400">Guarde este arquivo em local seguro.</p>
                    <div class="mt-4 p-3 bg-purple-500/10 border border-purple-500/30 rounded-lg">
                        <p class="text-xs text-purple-300">üìÅ ${a.download}</p>
                    </div>
                </div>`
            );
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function (e) {
                try {
                    const data = JSON.parse(e.target.result);

                    showConfirmModal(
                        'Importar Dados',
                        `<div class="space-y-3">
                            <p class="text-white">‚ö†Ô∏è Importar dados ir√° <strong class="text-red-400">SUBSTITUIR</strong> todos os dados atuais.</p>
                            <div class="card p-3 bg-slate-800">
                                <p class="text-xs text-slate-400 mb-1">Arquivo:</p>
                                <p class="text-sm text-white font-mono">${file.name}</p>
                            </div>
                            <div class="card p-3 bg-slate-800">
                                <p class="text-xs text-slate-400 mb-1">Data do Backup:</p>
                                <p class="text-sm text-white">${data.exportDate ? new Date(data.exportDate).toLocaleString('pt-BR') : 'Desconhecida'}</p>
                            </div>
                            <p class="text-yellow-400 text-sm">Deseja continuar?</p>
                        </div>`,
                        () => {
                            players = data.players || [];
                            loans = data.loans || [];
                            sales = data.sales || [];
                            youth = data.youth || [];

                            saveData();
                            updateUI();
                            updateSalesHistory();

                            showSuccessModal(
                                'Importa√ß√£o Conclu√≠da!',
                                `<div class="text-center">
                                    <div class="success-icon mb-4">
                                        <i class="fas fa-upload text-6xl text-blue-400"></i>
                                    </div>
                                    <p class="text-xl font-bold text-white mb-2">Dados importados com sucesso!</p>
                                    <div class="grid grid-cols-2 gap-2 mt-4">
                                        <div class="card p-2 bg-slate-800">
                                            <p class="text-xs text-slate-400">Profissionais</p>
                                            <p class="text-lg font-bold text-blue-400">${players.length}</p>
                                        </div>
                                        <div class="card p-2 bg-slate-800">
                                            <p class="text-xs text-slate-400">Base</p>
                                            <p class="text-lg font-bold text-yellow-400">${youth.length}</p>
                                        </div>
                                    </div>
                                </div>`
                            );
                        }
                    );
                } catch (error) {
                    showAlertModal(
                        'Erro na Importa√ß√£o',
                        `<div class="text-center">
                            <i class="fas fa-exclamation-circle text-5xl text-red-400 mb-3"></i>
                            <p class="text-white mb-2">Erro ao importar arquivo!</p>
                            <p class="text-sm text-slate-400">Verifique se √© um arquivo v√°lido.</p>
                        </div>`
                    );
                    console.error(error);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function updateUI() {
            const pTable = document.getElementById('playerTable');
            const pTableMobile = document.getElementById('playerTableMobile');
            const lLog = document.getElementById('loanList');
            const sLog = document.getElementById('salesLog');
            const simSelect = document.getElementById('simPlayer');
            const quickSaleSelect = document.getElementById('quickSalePlayer');
            const youthTable = document.getElementById('youthTable');
            const youthTableMobile = document.getElementById('youthTableMobile');
            const filter = document.getElementById('filterPos')?.value.toUpperCase() || '';
            const filterY = document.getElementById('filterYouth')?.value.toUpperCase() || '';

            if (pTable) pTable.innerHTML = '';
            if (pTableMobile) pTableMobile.innerHTML = '';
            if (lLog) lLog.innerHTML = '';
            if (sLog) sLog.innerHTML = '';
            if (simSelect) simSelect.innerHTML = '<option value="">Selecionar Atleta...</option>';
            if (quickSaleSelect) quickSaleSelect.innerHTML = '<option value="">Selecionar Jogador...</option>';
            if (youthTable) youthTable.innerHTML = '';
            if (youthTableMobile) youthTableMobile.innerHTML = '';

            players.sort((a, b) => (posOrder[a.pos] || 99) - (posOrder[b.pos] || 99));

            let squadSum = 0; let loanSum = 0; let profitSum = 0;

            players.forEach((p, i) => {
                if (filter === "" || p.pos.includes(filter) || p.nome.toUpperCase().includes(filter)) {
                    squadSum += p.valor;
                    
                    // Desktop table
                    if (pTable) {
                        pTable.innerHTML += `
                            <tr class="border-b border-slate-700/50 hover:bg-slate-800/30">
                                <td class="py-3">
                                    <span class="font-bold text-white text-xs">${p.nome}</span>
                                    <span class="${getPosClass(p.pos)} px-1.5 py-0.5 rounded text-[8px] ml-1 font-black uppercase inline-block w-8 text-center">${p.pos}</span>
                                </td>
                                <td class="py-3 text-right font-mono text-[10px]">${formatMoney(p.valor)}</td>
                                <td class="py-3 text-right space-x-2">
                                    <button onclick="openEditModal(${i})" class="text-blue-400 hover:text-blue-300" title="Editar"><i class="fa fa-edit"></i></button>
                                    <button onclick="sendToLoan(${i})" class="text-orange-400 hover:text-orange-300" title="Emprestar"><i class="fa fa-handshake"></i></button>
                                    <button onclick="deletePlayer(${i})" class="text-red-500 hover:text-red-400" title="Excluir"><i class="fa fa-trash"></i></button>
                                </td>
                            </tr>`;
                    }
                    
                    // Mobile cards
                    if (pTableMobile) {
                        pTableMobile.innerHTML += `
                            <div class="card p-3 mb-3 bg-slate-800/50">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <span class="font-bold text-white text-sm block">${p.nome}</span>
                                        <span class="${getPosClass(p.pos)} px-2 py-0.5 rounded text-[9px] font-black uppercase inline-block mt-1">${p.pos}</span>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-xs text-slate-400">Valor</p>
                                        <p class="font-mono text-sm text-white">${formatMoney(p.valor)}</p>
                                    </div>
                                </div>
                                <div class="flex gap-2 pt-2 border-t border-slate-700">
                                    <button onclick="openEditModal(${i})" class="flex-1 px-3 py-1.5 bg-blue-600 rounded text-xs">
                                        <i class="fa fa-edit mr-1"></i>Editar
                                    </button>
                                    <button onclick="sendToLoan(${i})" class="flex-1 px-3 py-1.5 bg-orange-600 rounded text-xs">
                                        <i class="fa fa-handshake mr-1"></i>Emprestar
                                    </button>
                                    <button onclick="deletePlayer(${i})" class="px-3 py-1.5 bg-red-600 rounded text-xs">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </div>
                            </div>`;
                    }
                    
                    if (simSelect) simSelect.innerHTML += `<option value="${i}">${p.nome} (${p.pos})</option>`;
                    if (quickSaleSelect) quickSaleSelect.innerHTML += `<option value="${i}">${p.nome} - ${formatMoney(p.valor)}</option>`;
                }
            });

            loans.forEach((p, i) => {
                loanSum += p.valor;
                if (lLog) {
                    lLog.innerHTML += `<div class="flex justify-between items-center border-b border-slate-800 pb-1">
                        <span>${p.nome} <span class="text-slate-500">(${p.pos})</span></span>
                        <button onclick="returnFromLoan(${i})" class="text-blue-400 font-bold">VOLTAR</button>
                    </div>`;
                }
            });

            sales.slice().reverse().slice(0, 5).forEach(s => {
                const profit = s.sale - s.cost;
                profitSum += profit;
                if (sLog) {
                    sLog.innerHTML += `<div class="flex justify-between border-b border-slate-800 pb-1 italic">
                        <span class="truncate w-24">${s.nome}</span>
                        <span class="${profit >= 0 ? 'positive' : 'negative'}">${formatMoney(profit)}</span>
                    </div>`;
                }
            });

            profitSum = sales.reduce((acc, s) => acc + (s.sale - s.cost), 0);

            if (document.getElementById('squadValue')) document.getElementById('squadValue').innerText = formatMoney(squadSum);
            if (document.getElementById('loanValue')) document.getElementById('loanValue').innerText = formatMoney(loanSum);
            if (document.getElementById('totalProfit')) document.getElementById('totalProfit').innerText = formatMoney(profitSum);
            if (document.getElementById('totalEquity')) document.getElementById('totalEquity').innerText = formatMoney(squadSum + loanSum + profitSum);

            // Youth stats
            let totalOvr = 0, totalPot = 0;
            youth.forEach((y, i) => {
                if (filterY === "" || y.pos.includes(filterY) || y.nome.toUpperCase().includes(filterY)) {
                    totalOvr += y.overall;
                    totalPot += y.potential;
                    const growth = y.potential - y.overall;
                    
                    // Desktop table
                    if (youthTable) {
                        youthTable.innerHTML += `
                            <tr class="border-b border-slate-700/50 hover:bg-slate-800/30">
                                <td class="py-3">
                                    <span class="font-bold text-white text-xs">${y.nome}</span>
                                    <span class="${getPosClass(y.pos)} px-1.5 py-0.5 rounded text-[8px] ml-1 font-black uppercase inline-block w-8 text-center">${y.pos}</span>
                                </td>
                                <td class="py-3 text-center text-slate-300 text-xs">${y.age}</td>
                                <td class="py-3 text-center">
                                    <span class="${getOvrClass(y.overall)} px-2 py-0.5 rounded text-[10px] font-bold">${y.overall}</span>
                                </td>
                                <td class="py-3 text-center">
                                    <span class="bg-pink-900/50 text-pink-300 px-2 py-0.5 rounded text-[10px] font-bold">${y.potential}</span>
                                    ${growth > 0 ? `<span class="text-green-400 text-[9px] ml-1">+${growth}</span>` : ''}
                                </td>
                                <td class="py-3 text-right font-mono text-[10px] text-slate-300">${formatMoney(y.value)}</td>
                                <td class="py-3 text-right space-x-2">
                                    <button onclick="openEditYouthModal(${i})" class="text-blue-400 hover:text-blue-300" title="Editar"><i class="fa fa-edit"></i></button>
                                    <button onclick="promoteYouth(${i})" class="text-green-500 hover:text-green-400" title="Promover"><i class="fa fa-arrow-up"></i></button>
                                    <button onclick="deleteYouth(${i})" class="text-red-500 hover:text-red-400" title="Excluir"><i class="fa fa-trash"></i></button>
                                </td>
                            </tr>`;
                    }
                    
                    // Mobile cards
                    if (youthTableMobile) {
                        youthTableMobile.innerHTML += `
                            <div class="card p-3 mb-3 bg-slate-800/50">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <span class="font-bold text-white text-sm block">${y.nome}</span>
                                        <div class="flex gap-2 items-center mt-1">
                                            <span class="${getPosClass(y.pos)} px-2 py-0.5 rounded text-[9px] font-black uppercase">${y.pos}</span>
                                            <span class="text-xs text-slate-400">${y.age} anos</span>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-xs text-slate-400">Valor</p>
                                        <p class="font-mono text-sm text-white">${formatMoney(y.value)}</p>
                                    </div>
                                </div>
                                <div class="flex gap-2 mb-2">
                                    <div class="flex-1 text-center ${getOvrClass(y.overall)} rounded p-1.5">
                                        <p class="text-[9px]">OVR</p>
                                        <p class="text-lg font-bold">${y.overall}</p>
                                    </div>
                                    <div class="flex-1 text-center bg-pink-900/50 text-pink-300 rounded p-1.5">
                                        <p class="text-[9px]">POT</p>
                                        <p class="text-lg font-bold">${y.potential}</p>
                                    </div>
                                    ${growth > 0 ? `<div class="flex items-center px-2 bg-green-900/30 text-green-400 rounded">
                                        <span class="text-sm font-bold">+${growth}</span>
                                    </div>` : ''}
                                </div>
                                <div class="flex gap-2 pt-2 border-t border-slate-700">
                                    <button onclick="openEditYouthModal(${i})" class="flex-1 px-3 py-1.5 bg-blue-600 rounded text-xs">
                                        <i class="fa fa-edit mr-1"></i>Editar
                                    </button>
                                    <button onclick="promoteYouth(${i})" class="flex-1 px-3 py-1.5 bg-green-600 rounded text-xs">
                                        <i class="fa fa-arrow-up mr-1"></i>Promover
                                    </button>
                                    <button onclick="deleteYouth(${i})" class="px-3 py-1.5 bg-red-600 rounded text-xs">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </div>
                            </div>`;
                    }
                }
            });

            if (document.getElementById('youthCount')) document.getElementById('youthCount').innerText = youth.length;
            if (document.getElementById('avgOverall')) document.getElementById('avgOverall').innerText = youth.length > 0 ? (totalOvr / youth.length).toFixed(0) : '0';
            if (document.getElementById('avgPotential')) document.getElementById('avgPotential').innerText = youth.length > 0 ? (totalPot / youth.length).toFixed(0) : '0';

            saveData();
        }

        function simulateOffer() {
            const idx = document.getElementById('simPlayer').value;
            const off = parseFloat(document.getElementById('simOffer').value);
            const res = document.getElementById('simResult');
            if (idx !== "" && off) {
                const p = players[idx];
                const prof = off - p.valor;
                res.classList.remove('hidden');
                res.innerHTML = `<p class="${prof >= 0 ? 'positive' : 'negative'} font-bold">Saldo: ${formatMoney(prof)}</p>
                                 <p class="text-[10px] text-slate-400">Margem: ${((prof / p.valor) * 100).toFixed(1)}%</p>`;
            }
        }

        function registerPlayer() {
            const n = document.getElementById('regName').value;
            const p = document.getElementById('regPos').value.toUpperCase();
            const v = parseFloat(document.getElementById('regValue').value);
            if (n && p && v) {
                players.push({ nome: n, pos: p, valor: v });
                document.getElementById('regName').value = '';
                document.getElementById('regPos').value = '';
                document.getElementById('regValue').value = '';
                updateUI();
                
                showSuccessModal(
                    'Jogador Cadastrado!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-user-plus text-6xl text-blue-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white mb-1">${n}</p>
                        <p class="text-sm text-slate-400 mb-3">${p} ‚Ä¢ ${formatMoney(v)}</p>
                        <p class="text-xs text-green-400">Adicionado ao elenco profissional!</p>
                    </div>`
                );
            } else {
                showAlertModal('Campos Incompletos', 'Por favor, preencha todos os campos para cadastrar o jogador.');
            }
        }

        function registerYouth() {
            const n = document.getElementById('youthName').value;
            const age = parseInt(document.getElementById('youthAge').value);
            const p = document.getElementById('youthPos').value.toUpperCase();
            const ovr = parseInt(document.getElementById('youthOverall').value);
            const pot = parseInt(document.getElementById('youthPotential').value);
            const v = parseFloat(document.getElementById('youthValue').value);

            if (n && age && p && ovr && pot && v) {
                if (pot < ovr) {
                    showAlertModal('Aten√ß√£o', 'O Potencial n√£o pode ser menor que o Overall!');
                    return;
                }
                youth.push({ nome: n, age: age, pos: p, overall: ovr, potential: pot, value: v });
                document.getElementById('youthName').value = '';
                document.getElementById('youthAge').value = '';
                document.getElementById('youthPos').value = '';
                document.getElementById('youthOverall').value = '';
                document.getElementById('youthPotential').value = '';
                document.getElementById('youthValue').value = '';
                updateUI();
                
                showSuccessModal(
                    'Jogador Cadastrado na Base!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-seedling text-6xl text-yellow-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white mb-1">${n}</p>
                        <p class="text-sm text-slate-400 mb-2">${age} anos ‚Ä¢ ${p}</p>
                        <div class="flex justify-center gap-3 mb-3">
                            <div class="card p-2 bg-slate-800">
                                <p class="text-[9px] text-slate-500">OVR</p>
                                <p class="text-lg font-bold text-cyan-400">${ovr}</p>
                            </div>
                            <div class="card p-2 bg-slate-800">
                                <p class="text-[9px] text-slate-500">POT</p>
                                <p class="text-lg font-bold text-pink-400">${pot}</p>
                            </div>
                        </div>
                        <p class="text-xs text-green-400">Adicionado √† base/academia!</p>
                    </div>`
                );
            } else {
                showAlertModal('Campos Incompletos', 'Por favor, preencha todos os campos para cadastrar o jogador.');
            }
        }

        function openEditModal(i) {
            const p = players[i];
            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-edit"></i> Editar Atleta';
            document.getElementById('modalBody').innerHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-4">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full mx-auto flex items-center justify-center mb-3">
                            <i class="fas fa-user text-3xl text-white"></i>
                        </div>
                        <p class="text-lg font-bold text-white">${p.nome}</p>
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 mb-1 block">Nome do Jogador</label>
                        <input type="text" id="editName" class="input-field" value="${p.nome}">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs text-slate-400 mb-1 block">Posi√ß√£o</label>
                            <input type="text" id="editPos" class="input-field" value="${p.pos}">
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 mb-1 block">Valor de Mercado</label>
                            <input type="number" id="editVal" class="input-field" value="${p.valor}">
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('modalConfirmBtn').onclick = () => {
                players[i].nome = document.getElementById('editName').value;
                players[i].pos = document.getElementById('editPos').value.toUpperCase();
                players[i].valor = parseFloat(document.getElementById('editVal').value);
                updateUI();
                closeModal();
                showSuccessModal(
                    'Jogador Atualizado!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-check-circle text-6xl text-green-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white">${players[i].nome}</p>
                        <p class="text-sm text-slate-400">foi atualizado com sucesso!</p>
                    </div>`
                );
            };
            document.getElementById('modalConfirmBtn').style.display = 'block';
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function openEditYouthModal(i) {
            const y = youth[i];
            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-edit"></i> Editar Jogador da Base';
            document.getElementById('modalBody').innerHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-4">
                        <div class="w-20 h-20 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-full mx-auto flex items-center justify-center mb-3">
                            <i class="fas fa-seedling text-3xl text-white"></i>
                        </div>
                        <p class="text-lg font-bold text-white">${y.nome}</p>
                        <p class="text-xs text-slate-400">${y.age} anos ‚Ä¢ ${y.pos}</p>
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 mb-1 block">Nome do Jogador</label>
                        <input type="text" id="editYName" class="input-field" value="${y.nome}">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs text-slate-400 mb-1 block">Idade</label>
                            <input type="number" id="editYAge" class="input-field" value="${y.age}">
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 mb-1 block">Posi√ß√£o</label>
                            <input type="text" id="editYPos" class="input-field" value="${y.pos}">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-xs text-slate-400 mb-1 block">Overall</label>
                            <input type="number" id="editYOvr" class="input-field" value="${y.overall}">
                        </div>
                        <div>
                            <label class="text-xs text-slate-400 mb-1 block">Potencial</label>
                            <input type="number" id="editYPot" class="input-field" value="${y.potential}">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 mb-1 block">Valor de Mercado</label>
                        <input type="number" id="editYVal" class="input-field" value="${y.value}">
                    </div>
                </div>
            `;
            document.getElementById('modalConfirmBtn').onclick = () => {
                const ovr = parseInt(document.getElementById('editYOvr').value);
                const pot = parseInt(document.getElementById('editYPot').value);
                if (pot < ovr) {
                    showAlertModal('Aten√ß√£o', 'O Potencial n√£o pode ser menor que o Overall!');
                    return;
                }
                youth[i].nome = document.getElementById('editYName').value;
                youth[i].age = parseInt(document.getElementById('editYAge').value);
                youth[i].pos = document.getElementById('editYPos').value.toUpperCase();
                youth[i].overall = ovr;
                youth[i].potential = pot;
                youth[i].value = parseFloat(document.getElementById('editYVal').value);
                updateUI();
                closeModal();
                showSuccessModal(
                    'Jogador Atualizado!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-check-circle text-6xl text-green-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white">${youth[i].nome}</p>
                        <p class="text-sm text-slate-400">foi atualizado com sucesso!</p>
                    </div>`
                );
            };
            document.getElementById('modalConfirmBtn').style.display = 'block';
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function promoteYouth(i) {
            const youth_player = youth[i];
            showConfirmModal(
                'Promover Jogador',
                `Promover <strong class="text-blue-400">${youth_player.nome}</strong> para o elenco profissional?`,
                () => {
                    const y = youth.splice(i, 1)[0];
                    players.push({ nome: y.nome, pos: y.pos, valor: y.value });
                    updateUI();
                    showSuccessModal(
                        'Promo√ß√£o Conclu√≠da!',
                        `<div class="text-center">
                            <div class="success-icon mb-4">
                                <i class="fas fa-arrow-circle-up text-6xl text-green-400"></i>
                            </div>
                            <p class="text-xl font-bold text-white mb-2">${y.nome}</p>
                            <p class="text-sm text-slate-400">foi promovido ao elenco profissional!</p>
                        </div>`
                    );
                }
            );
        }

        function updateQuickSalePreview() {
            const idx = document.getElementById('quickSalePlayer').value;
            const costDiv = document.getElementById('quickSaleCost');
            const costValue = document.getElementById('quickCostValue');
            const priceInput = document.getElementById('quickSalePrice');

            if (idx !== "") {
                const player = players[idx];
                costValue.innerText = formatMoney(player.valor);
                costDiv.classList.remove('hidden');

                const suggestedPrice = Math.round(player.valor * 1.3);
                priceInput.value = suggestedPrice;
                updateQuickSaleProfit();
            } else {
                costDiv.classList.add('hidden');
                document.getElementById('quickSaleProfit').classList.add('hidden');
                priceInput.value = '';
            }
        }

        function updateQuickSaleProfit() {
            const idx = document.getElementById('quickSalePlayer').value;
            const salePrice = parseFloat(document.getElementById('quickSalePrice').value);
            const profitDiv = document.getElementById('quickSaleProfit');
            const profitValue = document.getElementById('quickProfitValue');

            if (idx !== "" && salePrice) {
                const player = players[idx];
                const profit = salePrice - player.valor;
                profitValue.innerText = formatMoney(profit);
                profitValue.className = `font-bold text-lg ${profit >= 0 ? 'positive' : 'negative'}`;
                profitDiv.classList.remove('hidden');
            } else {
                profitDiv.classList.add('hidden');
            }
        }

        function executeQuickSale() {
            const idx = document.getElementById('quickSalePlayer').value;
            const salePrice = parseFloat(document.getElementById('quickSalePrice').value);

            if (idx !== "" && salePrice) {
                const player = players.splice(idx, 1)[0];
                const profit = salePrice - player.valor;
                sales.push({ nome: player.nome, cost: player.valor, sale: salePrice });

                document.getElementById('quickSalePlayer').value = '';
                document.getElementById('quickSalePrice').value = '';
                document.getElementById('quickSaleCost').classList.add('hidden');
                document.getElementById('quickSaleProfit').classList.add('hidden');

                updateUI();
                updateSalesHistory();

                showSuccessModal(
                    'Venda Conclu√≠da!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-check-circle text-6xl text-green-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white mb-2">${player.nome}</p>
                        <p class="text-sm text-slate-400 mb-4">foi vendido com sucesso!</p>
                        <div class="grid grid-cols-2 gap-4 text-left">
                            <div class="card p-3 bg-slate-800">
                                <p class="text-xs text-slate-500 mb-1">Valor de Venda</p>
                                <p class="text-lg font-bold text-white">${formatMoney(salePrice)}</p>
                            </div>
                            <div class="card p-3 bg-slate-800">
                                <p class="text-xs text-slate-500 mb-1">Lucro Obtido</p>
                                <p class="text-lg font-bold ${profit >= 0 ? 'text-green-400' : 'text-red-400'}">${formatMoney(profit)}</p>
                            </div>
                        </div>
                    </div>`
                );
            } else {
                showAlertModal('Aten√ß√£o', 'Selecione um jogador e informe o valor da venda');
            }
        }

        function openBulkRegisterModal() {
            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-list"></i> Cadastro em Lote - Elenco Profissional';
            document.getElementById('modalBody').innerHTML = `
                <div class="space-y-3">
                    <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-4">
                        <p class="text-sm text-slate-300 mb-2 font-semibold">üìã Formato esperado:</p>
                        <code class="text-xs text-blue-300 bg-black/30 px-2 py-1 rounded block">Nome, Posi√ß√£o, Valor</code>
                        <p class="text-xs text-slate-400 mt-2">
                            <i class="fas fa-info-circle text-blue-400"></i> 
                            Aceita v√≠rgula (,) tra√ßo (-) ou pipe (|) como separador
                        </p>
                    </div>
                    <textarea id="bulkData" class="input-field h-64 font-mono text-xs" placeholder="Neymar, ATA, 50000000
Casemiro, VOL, 30000000
Alisson, GL, 40000000"></textarea>
                </div>
            `;
            document.getElementById('modalConfirmBtn').onclick = () => {
                const text = document.getElementById('bulkData').value;
                const lines = text.split('\n').filter(l => l.trim());
                let count = 0;

                lines.forEach(line => {
                    const parts = line.split(/[,|\-]/).map(p => p.trim());
                    if (parts.length >= 3) {
                        const nome = parts[0];
                        const pos = parts[1].toUpperCase();
                        const valor = parseFloat(parts[2].replace(/[^\d]/g, ''));
                        if (nome && pos && valor) {
                            players.push({ nome, pos, valor });
                            count++;
                        }
                    }
                });

                updateUI();
                closeModal();
                showSuccessModal(
                    'Cadastro Completo!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-users text-6xl text-green-400"></i>
                        </div>
                        <p class="text-2xl font-bold text-white mb-2">${count}</p>
                        <p class="text-sm text-slate-400">jogador(es) cadastrado(s) com sucesso!</p>
                    </div>`
                );
            };
            document.getElementById('modalConfirmBtn').style.display = 'block';
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function openBulkYouthModal() {
            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-list"></i> Cadastro em Lote - Base/Academia';
            document.getElementById('modalBody').innerHTML = `
                <div class="space-y-3">
                    <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4">
                        <p class="text-sm text-slate-300 mb-2 font-semibold">üìã Formato esperado:</p>
                        <code class="text-xs text-yellow-300 bg-black/30 px-2 py-1 rounded block">Nome, Idade, Posi√ß√£o, Overall, Potencial, Valor</code>
                        <p class="text-xs text-slate-400 mt-2">
                            <i class="fas fa-info-circle text-yellow-400"></i> 
                            Aceita v√≠rgula (,) tra√ßo (-) ou pipe (|) como separador
                        </p>
                    </div>
                    <textarea id="bulkYouthData" class="input-field h-64 font-mono text-xs" placeholder="Jo√£o Silva, 17, ATA, 65, 82, 5000000
Pedro Santos, 16, VOL, 60, 78, 3000000
Lucas Oliveira, 18, ZAG, 68, 80, 4000000"></textarea>
                </div>
            `;
            document.getElementById('modalConfirmBtn').onclick = () => {
                const text = document.getElementById('bulkYouthData').value;
                const lines = text.split('\n').filter(l => l.trim());
                let count = 0;

                lines.forEach(line => {
                    const parts = line.split(/[,|\-]/).map(p => p.trim());
                    if (parts.length >= 6) {
                        const nome = parts[0];
                        const age = parseInt(parts[1]);
                        const pos = parts[2].toUpperCase();
                        const overall = parseInt(parts[3]);
                        const potential = parseInt(parts[4]);
                        const value = parseFloat(parts[5].replace(/[^\d]/g, ''));

                        if (nome && age && pos && overall && potential && value && potential >= overall) {
                            youth.push({ nome, age, pos, overall, potential, value });
                            count++;
                        }
                    }
                });

                updateUI();
                closeModal();
                showSuccessModal(
                    'Cadastro Completo!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-seedling text-6xl text-yellow-400"></i>
                        </div>
                        <p class="text-2xl font-bold text-white mb-2">${count}</p>
                        <p class="text-sm text-slate-400">jogador(es) da base cadastrado(s) com sucesso!</p>
                    </div>`
                );
            };
            document.getElementById('modalConfirmBtn').style.display = 'block';
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function openCareerManagementModal() {
            document.getElementById('modalTitle').innerText = "Gerenciar Carreiras";
            
            let careerListHTML = '';
            Object.keys(careers).forEach(careerKey => {
                const career = careers[careerKey];
                const isActive = careerKey === currentCareer;
                const playerCount = career.players?.length || 0;
                const youthCount = career.youth?.length || 0;
                const salesCount = career.sales?.length || 0;
                
                careerListHTML += `
                    <div class="card p-4 mb-3 ${isActive ? 'border-l-4 border-l-blue-500 bg-blue-500/10' : 'border-slate-700'} relative">
                        ${isActive ? '<div class="absolute top-2 right-2 text-blue-400 text-xs font-bold uppercase"><i class="fas fa-star"></i> Ativa</div>' : ''}
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex-1">
                                <h4 class="font-bold text-white text-sm">${career.name}</h4>
                                <p class="text-[10px] text-slate-500">Criada em: ${new Date(career.createdAt).toLocaleDateString('pt-BR')}</p>
                                ${career.lastUpdate ? `<p class="text-[10px] text-slate-500">√öltima atualiza√ß√£o: ${new Date(career.lastUpdate).toLocaleDateString('pt-BR')}</p>` : ''}
                            </div>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center text-xs mb-3">
                            <div class="bg-blue-500/20 rounded p-2">
                                <p class="text-blue-400 font-bold">${playerCount}</p>
                                <p class="text-slate-400 text-[9px]">Profissionais</p>
                            </div>
                            <div class="bg-yellow-500/20 rounded p-2">
                                <p class="text-yellow-400 font-bold">${youthCount}</p>
                                <p class="text-slate-400 text-[9px]">Base</p>
                            </div>
                            <div class="bg-green-500/20 rounded p-2">
                                <p class="text-green-400 font-bold">${salesCount}</p>
                                <p class="text-slate-400 text-[9px]">Vendas</p>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            ${!isActive ? `<button onclick="switchCareer('${careerKey}')" class="flex-1 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 rounded text-[10px] font-bold uppercase">
                                <i class="fas fa-exchange-alt"></i> Carregar
                            </button>` : ''}
                            <button onclick="renameCareer('${careerKey}')" class="flex-1 px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded text-[10px] font-bold uppercase">
                                <i class="fas fa-edit"></i> Renomear
                            </button>
                            ${!isActive ? `<button onclick="deleteCareer('${careerKey}')" class="flex-1 px-3 py-1.5 bg-red-600 hover:bg-red-700 rounded text-[10px] font-bold uppercase">
                                <i class="fas fa-trash"></i> Excluir
                            </button>` : ''}
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('modalBody').innerHTML = `
                <div class="space-y-4">
                    <div class="card p-4 border-l-4 border-l-green-500 bg-green-500/5">
                        <h3 class="font-bold text-green-400 mb-2 flex items-center gap-2">
                            <i class="fas fa-plus-circle"></i> Nova Carreira
                        </h3>
                        <p class="text-xs text-slate-400 mb-3">Criar uma nova carreira vazia (a atual continua salva)</p>
                        <button onclick="createNewCareer()" class="w-full px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-xs font-bold uppercase">
                            <i class="fas fa-plus"></i> Criar Nova Carreira
                        </button>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-300 mb-3 flex items-center gap-2">
                            <i class="fas fa-list"></i> Minhas Carreiras (${Object.keys(careers).length})
                        </h3>
                        <div class="max-h-96 overflow-y-auto space-y-2">
                            ${careerListHTML}
                        </div>
                    </div>

                    <div class="card p-4 border-l-4 border-l-red-500 bg-red-500/5">
                        <h3 class="font-bold text-red-400 mb-2 flex items-center gap-2">
                            <i class="fas fa-exclamation-triangle"></i> Zona de Perigo
                        </h3>
                        <button onclick="clearCurrentCareer()" class="w-full px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-xs font-bold uppercase mb-2">
                            <i class="fas fa-broom"></i> Limpar Carreira Atual
                        </button>
                        <button onclick="deleteAllCareers()" class="w-full px-4 py-2 bg-red-800 hover:bg-red-900 rounded-lg text-xs font-bold uppercase">
                            <i class="fas fa-trash-alt"></i> Excluir Todas as Carreiras
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('modalConfirmBtn').style.display = 'none';
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function openCareerSelector() {
            openCareerManagementModal();
        }

        function createNewCareer() {
            const careerNumber = Object.keys(careers).length + 1;
            const newCareerKey = `carreira_${Date.now()}`;
            const careerName = prompt(`Nome da nova carreira:`, `Carreira ${careerNumber}`);
            
            if (careerName) {
                careers[newCareerKey] = {
                    name: careerName,
                    players: [],
                    loans: [],
                    sales: [],
                    youth: [],
                    createdAt: new Date().toISOString()
                };
                
                localStorage.setItem('careers_v22', JSON.stringify(careers));
                
                showConfirmModal(
                    'Carreira Criada!',
                    `A carreira "<strong class="text-blue-400">${careerName}</strong>" foi criada com sucesso!<br><br>Deseja trocar para ela agora?`,
                    () => {
                        switchCareer(newCareerKey);
                    }
                );
            }
        }

        function switchCareer(careerKey) {
            if (careers[careerKey]) {
                currentCareer = careerKey;
                players = careers[careerKey].players || [];
                loans = careers[careerKey].loans || [];
                sales = careers[careerKey].sales || [];
                youth = careers[careerKey].youth || [];
                
                localStorage.setItem('currentCareer_v22', currentCareer);
                document.getElementById('currentCareerName').innerText = careers[careerKey].name;
                
                updateUI();
                updateSalesHistory();
                closeModal();
                
                showSuccessModal(
                    'Carreira Carregada!',
                    `<div class="text-center">
                        <div class="success-icon mb-4">
                            <i class="fas fa-folder-open text-6xl text-blue-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white mb-2">${careers[careerKey].name}</p>
                        <p class="text-sm text-slate-400">carregada com sucesso!</p>
                    </div>`
                );
            }
        }

        function renameCareer(careerKey) {
            const newName = prompt('Novo nome da carreira:', careers[careerKey].name);
            if (newName && newName.trim()) {
                careers[careerKey].name = newName.trim();
                localStorage.setItem('careers_v22', JSON.stringify(careers));
                
                if (careerKey === currentCareer) {
                    document.getElementById('currentCareerName').innerText = newName.trim();
                }
                
                openCareerManagementModal();
            }
        }

        function deleteCareer(careerKey) {
            if (careerKey === currentCareer) {
                showAlertModal('Aten√ß√£o', 'Voc√™ n√£o pode excluir a carreira ativa!<br><br>Troque para outra carreira antes de excluir esta.');
                return;
            }
            
            showConfirmModal(
                'Excluir Carreira',
                `Tem certeza que deseja excluir a carreira "<strong class="text-red-400">${careers[careerKey].name}</strong>"?<br><br>Esta a√ß√£o n√£o pode ser desfeita!`,
                () => {
                    delete careers[careerKey];
                    localStorage.setItem('careers_v22', JSON.stringify(careers));
                    openCareerManagementModal();
                    setTimeout(() => {
                        showSuccessModal('Carreira Exclu√≠da', `<div class="text-center"><i class="fas fa-trash text-6xl text-red-400 mb-4"></i><p class="text-white">Carreira exclu√≠da com sucesso!</p></div>`);
                    }, 300);
                }
            );
        }

        function clearCurrentCareer() {
            showConfirmModal(
                'Limpar Carreira',
                `<div class="text-center">
                    <i class="fas fa-broom text-5xl text-orange-400 mb-3"></i>
                    <p class="text-white mb-2">Limpar a carreira <strong class="text-orange-400">"${careers[currentCareer].name}"</strong>?</p>
                    <p class="text-sm text-slate-400 mb-3">Todos os jogadores, vendas e dados ser√£o apagados!</p>
                    <p class="text-xs text-red-400">Esta a√ß√£o n√£o pode ser desfeita!</p>
                </div>`,
                () => {
                    showConfirmModal(
                        'Confirma√ß√£o Final',
                        `<div class="text-center">
                            <i class="fas fa-exclamation-triangle text-6xl text-red-400 mb-3 alert-shake"></i>
                            <p class="text-xl text-white font-bold mb-2">TEM CERTEZA?</p>
                            <p class="text-sm text-slate-400">Esta √© sua √∫ltima chance de cancelar!</p>
                        </div>`,
                        () => {
                            players = [];
                            loans = [];
                            sales = [];
                            youth = [];
                            saveData();
                            updateUI();
                            updateSalesHistory();
                            closeModal();
                            
                            setTimeout(() => {
                                showSuccessModal(
                                    'Carreira Limpa!',
                                    `<div class="text-center">
                                        <i class="fas fa-check-circle text-6xl text-green-400 mb-3"></i>
                                        <p class="text-white">Carreira limpa com sucesso!</p>
                                    </div>`
                                );
                            }, 300);
                        }
                    );
                }
            );
        }

        function deleteAllCareers() {
            showConfirmModal(
                '‚ö†Ô∏è PERIGO EXTREMO',
                `<div class="text-center">
                    <i class="fas fa-radiation text-6xl text-red-500 mb-3 alert-shake"></i>
                    <p class="text-xl text-red-400 font-bold mb-2">EXCLUIR TODAS AS CARREIRAS?</p>
                    <p class="text-white mb-3">TODOS os seus dados ser√£o perdidos permanentemente!</p>
                    <div class="card p-3 bg-red-900/20 border border-red-500/30">
                        <p class="text-sm text-red-300">‚ö†Ô∏è Esta a√ß√£o N√ÉO PODE ser desfeita!</p>
                        <p class="text-xs text-slate-400 mt-2">Todas as ${Object.keys(careers).length} carreira(s) ser√£o apagadas</p>
                    </div>
                </div>`,
                () => {
                    document.getElementById('modalTitle').innerHTML = '<i class="fas fa-key"></i> Confirma√ß√£o de Seguran√ßa';
                    document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-red-600 to-red-700 p-5 border-b border-red-500';
                    document.getElementById('modalBody').innerHTML = `
                        <div class="text-center">
                            <i class="fas fa-lock text-5xl text-red-400 mb-4"></i>
                            <p class="text-white mb-4">Digite <strong class="text-red-400">EXCLUIR TUDO</strong> para confirmar:</p>
                            <input type="text" id="confirmPassword" class="input-field text-center text-lg font-bold" placeholder="Digite aqui...">
                        </div>
                    `;
                    document.getElementById('modalConfirmBtn').onclick = () => {
                        const password = document.getElementById('confirmPassword').value;
                        if (password === 'EXCLUIR TUDO') {
                            localStorage.clear();
                            closeModal();
                            
                            // Modal de despedida antes de recarregar
                            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-check-circle"></i> Dados Exclu√≠dos';
                            document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-green-600 to-green-700 p-5 border-b border-green-500';
                            document.getElementById('modalBody').innerHTML = `
                                <div class="text-center">
                                    <i class="fas fa-trash-alt text-6xl text-green-400 mb-4"></i>
                                    <p class="text-xl text-white font-bold mb-2">Tudo limpo!</p>
                                    <p class="text-sm text-slate-400">Recarregando aplica√ß√£o...</p>
                                </div>
                            `;
                            document.getElementById('modalConfirmBtn').style.display = 'none';
                            document.getElementById('modalOverlay').classList.remove('hidden');
                            
                            setTimeout(() => location.reload(), 2000);
                        } else {
                            showAlertModal('Senha Incorreta', 'A senha est√° incorreta. Nenhum dado foi exclu√≠do.');
                        }
                    };
                    document.getElementById('modalConfirmBtn').style.display = 'block';
                    document.getElementById('modalOverlay').classList.remove('hidden');
                }
            );
        }

        function startNewCareer() {
            createNewCareer();
        }

        function executeNewCareer() {
            // Fun√ß√£o mantida para compatibilidade, mas agora redireciona para createNewCareer
            createNewCareer();
        }

        function clearAllSquad() {
            clearCurrentCareer();
        }

        function clearProfessionalOnly() {
            showConfirmModal(
                'Limpar Elenco Profissional',
                'Excluir apenas o elenco profissional e empr√©stimos?<br><br><span class="text-green-400">‚úì A base e o hist√≥rico de vendas ser√£o mantidos.</span>',
                () => {
                    players = [];
                    loans = [];
                    saveData();
                    updateUI();
                    closeModal();
                    
                    setTimeout(() => {
                        showSuccessModal(
                            'Elenco Limpo!',
                            `<div class="text-center">
                                <i class="fas fa-check-circle text-6xl text-green-400 mb-3"></i>
                                <p class="text-white">Elenco profissional limpo com sucesso!</p>
                            </div>`
                        );
                    }, 300);
                }
            );
        }

        function clearYouthOnly() {
            showConfirmModal(
                'Limpar Base/Academia',
                'Excluir todos os jogadores da base?<br><br><span class="text-green-400">‚úì O elenco profissional e hist√≥rico ser√£o mantidos.</span>',
                () => {
                    youth = [];
                    saveData();
                    updateUI();
                    closeModal();
                    
                    setTimeout(() => {
                        showSuccessModal(
                            'Base Limpa!',
                            `<div class="text-center">
                                <i class="fas fa-check-circle text-6xl text-green-400 mb-3"></i>
                                <p class="text-white">Base/Academia limpa com sucesso!</p>
                            </div>`
                        );
                    }, 300);
                }
            );
        }

        function clearSalesHistory() {
            showConfirmModal(
                'Limpar Hist√≥rico de Vendas',
                'Excluir todo o hist√≥rico de vendas?<br><br><span class="text-green-400">‚úì Os jogadores cadastrados ser√£o mantidos.</span>',
                () => {
                    sales = [];
                    saveData();
                    updateUI();
                    updateSalesHistory();
                    closeModal();
                    
                    setTimeout(() => {
                        showSuccessModal(
                            'Hist√≥rico Limpo!',
                            `<div class="text-center">
                                <i class="fas fa-check-circle text-6xl text-green-400 mb-3"></i>
                                <p class="text-white">Hist√≥rico de vendas limpo com sucesso!</p>
                            </div>`
                        );
                    }, 300);
                }
            );
        }

        function sendToLoan(i) { 
            const player = players[i];
            showConfirmModal(
                'Emprestar Jogador',
                `Enviar <strong class="text-orange-400">${player.nome}</strong> para empr√©stimo?`,
                () => {
                    loans.push(players.splice(i, 1)[0]);
                    updateUI();
                    showSuccessModal(
                        'Empr√©stimo Confirmado!',
                        `<div class="text-center">
                            <div class="success-icon mb-4">
                                <i class="fas fa-handshake text-6xl text-orange-400"></i>
                            </div>
                            <p class="text-xl font-bold text-white">${player.nome}</p>
                            <p class="text-sm text-slate-400">foi enviado para empr√©stimo!</p>
                        </div>`
                    );
                }
            );
        }
        
        function returnFromLoan(i) { 
            const player = loans[i];
            showConfirmModal(
                'Retornar de Empr√©stimo',
                `Retornar <strong class="text-blue-400">${player.nome}</strong> ao elenco principal?`,
                () => {
                    players.push(loans.splice(i, 1)[0]);
                    updateUI();
                    showSuccessModal(
                        'Retorno Confirmado!',
                        `<div class="text-center">
                            <div class="success-icon mb-4">
                                <i class="fas fa-undo text-6xl text-blue-400"></i>
                            </div>
                            <p class="text-xl font-bold text-white">${player.nome}</p>
                            <p class="text-sm text-slate-400">retornou ao elenco profissional!</p>
                        </div>`
                    );
                }
            );
        }
        
        function deletePlayer(i) { 
            const player = players[i];
            showConfirmModal(
                'Excluir Jogador',
                `<div class="text-center">
                    <i class="fas fa-exclamation-triangle text-5xl text-red-400 mb-3"></i>
                    <p class="text-white mb-2">Excluir <strong class="text-red-400">${player.nome}</strong> permanentemente?</p>
                    <p class="text-sm text-slate-400">Esta a√ß√£o n√£o pode ser desfeita!</p>
                </div>`,
                () => {
                    players.splice(i, 1);
                    updateUI();
                    showSuccessModal(
                        'Jogador Exclu√≠do',
                        `<div class="text-center">
                            <i class="fas fa-trash text-5xl text-red-400 mb-3"></i>
                            <p class="text-white">${player.nome} foi removido do elenco.</p>
                        </div>`
                    );
                }
            );
        }
        
        function deleteYouth(i) { 
            const player = youth[i];
            showConfirmModal(
                'Excluir Jogador da Base',
                `<div class="text-center">
                    <i class="fas fa-exclamation-triangle text-5xl text-red-400 mb-3"></i>
                    <p class="text-white mb-2">Excluir <strong class="text-red-400">${player.nome}</strong> da base?</p>
                    <p class="text-sm text-slate-400">Esta a√ß√£o n√£o pode ser desfeita!</p>
                </div>`,
                () => {
                    youth.splice(i, 1);
                    updateUI();
                    showSuccessModal(
                        'Jogador Exclu√≠do',
                        `<div class="text-center">
                            <i class="fas fa-trash text-5xl text-red-400 mb-3"></i>
                            <p class="text-white">${player.nome} foi removido da base.</p>
                        </div>`
                    );
                }
            );
        }
        function closeModal() { 
            document.getElementById('modalOverlay').classList.add('hidden');
            document.getElementById('modalConfirmBtn').style.display = 'block';
        }

        function closeWelcomeModal() {
            document.getElementById('welcomeModal').classList.add('hidden');
            localStorage.setItem('lastSeenVersion', APP_VERSION);
        }

        function showWelcomeModal() {
            document.getElementById('welcomeModal').classList.remove('hidden');
        }

        function openChangelogModal() {
            showWelcomeModal();
        }

        function showSuccessModal(title, content) {
            document.getElementById('modalTitle').innerHTML = `<i class="fas fa-check-circle"></i> ${title}`;
            document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-green-600 to-green-700 p-5 border-b border-green-500';
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modalConfirmBtn').style.display = 'none';
            document.getElementById('modalOverlay').classList.remove('hidden');
            
            setTimeout(() => {
                document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-blue-600 to-blue-700 p-5 border-b border-blue-500';
            }, 100);
        }

        function showAlertModal(title, message) {
            document.getElementById('modalTitle').innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${title}`;
            document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-yellow-600 to-orange-600 p-5 border-b border-yellow-500';
            document.getElementById('modalBody').innerHTML = `
                <div class="text-center alert-shake">
                    <div class="mb-4">
                        <i class="fas fa-exclamation-triangle text-6xl text-yellow-400"></i>
                    </div>
                    <p class="text-lg text-white">${message}</p>
                </div>
            `;
            document.getElementById('modalConfirmBtn').style.display = 'none';
            document.getElementById('modalOverlay').classList.remove('hidden');
            
            setTimeout(() => {
                document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-blue-600 to-blue-700 p-5 border-b border-blue-500';
            }, 100);
        }

        function showConfirmModal(title, message, onConfirm) {
            document.getElementById('modalTitle').innerHTML = `<i class="fas fa-question-circle"></i> ${title}`;
            document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-purple-600 to-purple-700 p-5 border-b border-purple-500';
            document.getElementById('modalBody').innerHTML = `
                <div class="text-center">
                    <div class="mb-4">
                        <i class="fas fa-question-circle text-6xl text-purple-400"></i>
                    </div>
                    <p class="text-lg text-white">${message}</p>
                </div>
            `;
            document.getElementById('modalConfirmBtn').style.display = 'block';
            document.getElementById('modalConfirmBtn').onclick = () => {
                onConfirm();
                closeModal();
            };
            document.getElementById('modalOverlay').classList.remove('hidden');
            
            setTimeout(() => {
                document.getElementById('modalTitle').parentElement.className = 'bg-gradient-to-r from-blue-600 to-blue-700 p-5 border-b border-blue-500';
            }, 100);
        }

        // Atualiza o nome da carreira na UI ao carregar
        document.getElementById('currentCareerName').innerText = careers[currentCareer].name;

        // Verifica se deve mostrar o modal de boas-vindas
        const lastSeenVersion = localStorage.getItem('lastSeenVersion');
        if (lastSeenVersion !== APP_VERSION) {
            setTimeout(() => {
                showWelcomeModal();
            }, 500);
        }

        updateUI();
    </script>
</body>

</html>